<html>
  <head>

  </head>

  <body>
    graph:
    <canvas id="canvas" width="700" height="700"></canvas>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
    <script>

    var fetchList = [];

    fetchList.push({
      query: '/query?addr=1>9.8&start=30m&aggr=1s&valueName=value0',
      index:0
    });

    fetchList.push({
      query: '/query?addr=1>9.8&start=30m&aggr=1s&valueName=value1',
      index:1
    });

    Promise.all(
        fetchList.map(fetchTask =>
          fetch(fetchTask.query)
            .then(response => response.json() )
        )
      ).then(sparks => {
        sparks.forEach((spark, i) => {
          fetchList[i].data = spark;
        });

        console.log(fetchList);

        var data = fetchList[0].data.map(function(e, i) {
           return { x: e._value, y: fetchList[1].data[i]._value }
        });


        var ctx = canvas.getContext('2d');
        var config = {
           type: 'scatter',
           data: {
              //labels: labels,
              datasets: [{
                 label: 'mag',
                 data: data
              }]
           },
           options: {
             responsive: false, // Instruct chart js to respond nicely.
    maintainAspectRatio: false, // Add to prevent default behaviour of full-width/height
              showLines: false,
              elements: {
                point: {
                  radius: 5
                }
              }
           }
        };

        var chart = new Chart(ctx, config);


      });


        /*

        var data = json.map(function(e) {
           return e._value;
        });;
        */


    </script>
  </body>
</html>
